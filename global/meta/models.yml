---
# Types:
#     - Nativ datatypes: text, string (text with maxLength=256), number, boolean, JSON
#     - HTMLStrict: A string with HTML content.
#     - HTMLPermissive: A string with HTML content (with video tags).
#     - float: Numbers that are expected to be non-integer. Formatted as in rfc7159.
#     - decimal: Decimal values represented as a string with X decimal places.
#       Without maxLength, the default is X=6.
#     - timestamp: Datetime as a unix timestamp. Why a number? This enables queries
#       in the DB. And we do not need more precision than 1 second.
#     - <T>[]: This indicates and arbitrary array of the given type. At the moment
#       we support only some types. You can add JSON Schema properties for items
#       using the extra property `items`
#     - color: string that must match ^#[0-9a-f]{6}$
#     - Xsqlview: table/field, where <boolean expression> results as a list of fields
# Relations:
#     - We have the following types: `relation`, `relation-list`, `generic-relation`
#       and `generic-relation-list`.
#     - Non-generic relations: The simple syntax for such a field
#       `references: table(field)`. Target of foreign key.
#       `to: <collection>/<field>`. This is a reference to a collection. The reverse
#       relation field in this collection is <field>. E. g. in a motion the field
#       `category_id` links to one category where the field `motion_ids` contains the
#       motion id. The simple notation for the field is `motion_category/motion_ids`.
#       The reverse field has type `relation-list` and is related back to
#       `motion/category_id`. The type indicates that there are many
#       motion ids.

#     - Generic relations: The difference to non-generic relations is that you have a
#       list of possible fields, so `to` can either hold multiple collections (if the
#       field name is the same):
#         to:
#           collections:
#             - agenda_item
#             - assignment
#             - ...
#           field: tag_ids
#       Or `to` can be a list of collection fields:
#         to:
#           - motion/option_ids
#           - user/option_$_ids
#     - os3_on_delete: This fields determines what should happen with the foreign model if
#       this model gets deleted. Possible values are:
#           - SET_NULL (default): delete the id from the foreign key
#           - PROTECT: if the foreign key is not empty, throw an error instead of
#                      deleting the object
#           - CASCADE: also delete all models in this foreign key
# JSON Schema Properties:
#     - You can add JSON Schema properties to the fields like `enum`, `description`,
#       `items`, `maxLength` and `minimum`
# Additional properties:
#     - The property `maxLength`: for types decimal, text, string and string[] you could define the maxLength
#     - The property `read_only` describes a field that can not be changed by an action.
#     - The property `default` describes the default value that is used for new objects.
#     - The property `required` describes that this field can not be null or an empty
#       string. If this field is given it must have some content. On relation and generic-relation
#       fields the value as to be an id of an existing object.
#     - The property `equal_fields` describes fields that must have the same value in
#       the instance and the related instance.
#     - The property `indexed` creates an index on database for faster access
# Restriction Mode:
#   The field `restriction_mode` is required for every field. It puts the field into a
#   restriction group. See https://github.com/OpenSlides/OpenSlides/wiki/Restrictions-Overview

organizationT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    maxLength: 50
    restriction_mode: A
  description:
    type: HTMLStrict
    restriction_mode: A

  # Settings (configurable by the client)
  legal_notice:
    type: text
    restriction_mode: A
  privacy_policy:
    type: text
    restriction_mode: A
  login_text:
    type: text
    restriction_mode: A
  reset_password_verbose_errors:
    type: boolean
    restriction_mode: B
  genders:
    type: string[]
    default:
      - male
      - female
      - diverse
      - non-binary
    restriction_mode: A

  # Configuration (only for the server owner)
  enable_electronic_voting:
    type: boolean
    restriction_mode: B
  enable_chat:
    type: boolean
    restriction_mode: B
  limit_of_meetings:
    type: number
    description: Maximum of active meetings for the whole organization. 0 means no limitation at all
    restriction_mode: B
    default: 0
    minimum: 0
  limit_of_users:
    type: number
    description: Maximum of active users for the whole organization. 0 means no limitation at all
    restriction_mode: B
    default: 0
    minimum: 0
  default_language:
    type: string
    restriction_mode: A
    enum:
      - en
      - de
      - it
      - es
      - ru
      - cs
    required: true

  # Saml settings
  saml_enabled:
    type: boolean
    restriction_mode: A
  saml_login_button_text:
    type: string
    default: SAML login
    restriction_mode: A
  saml_attr_mapping:
    type: JSON
    restriction_mode: A
  saml_metadata_idp:
    type: text
    restriction_mode: A
  saml_metadata_sp:
    type: text
    restriction_mode: A
  saml_private_key:
    type: text
    restriction_mode: A

  vote_decrypt_public_main_key:
    type: string
    description: Public key from vote decrypt to validate cryptographic votes.
    calculated: true
    restriction_mode: A

  theme_id:
    type: relation
    required: true
    restriction_mode: A
    references: theme(id)
  users_email_sender:
    type: string
    default: OpenSlides
    restriction_mode: A
  users_email_replyto:
    type: string
    restriction_mode: A
  users_email_subject:
    type: string
    default: OpenSlides access data
    restriction_mode: A
  users_email_body:
    type: text
    default: >-
      Dear {name},


      this is your personal OpenSlides login:


      {url}

      Username: {username}

      Password: {password}



      This email was generated automatically.
    restriction_mode: A
  url:
    type: string
    default: https://example.com
    restriction_mode: A

organization:
  entity_description:
    type: view
    table: organizationT
    table_letter: o
  committee_ids:
    type: number[]
    restriction_mode: B
    select: select array_agg(c.id) from committeeT c
  active_meeting_ids:
    type: number[]
    restriction_mode: B
    select: select array_agg(m.id) from meetingT m where m.state = 'active'
  archived_meeting_ids:
    type: number[]
    restriction_mode: B
    select: select array_agg(m.id) from meetingT m where m.state = 'archived'
  template_meeting_ids:
    type: number[]
    select: select array_agg(m.id) from meetingT m where m.template_for_organization
    restriction_mode: A
  organization_tag_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: organization_tag/id
  theme_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: theme/id
  mediafile_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: mediafile/id, where mediafile.owner_organization_id = 1
  user_ids:
    type: number[]
    restriction_mode: C
    Xsqlview: user/id

userT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  username:
    type: string
    required: true
    restriction_mode: A
  saml_id:
    type: string
    minLength: 1
    restriction_mode: A
    description: unique-key from IdP for SAML login
  pronoun:
    type: string
    maxLength: 32
    restriction_mode: A
  title:
    type: string
    restriction_mode: A
  first_name:
    type: string
    restriction_mode: A
  last_name:
    type: string
    restriction_mode: A
  is_active:
    type: boolean
    restriction_mode: D
  is_physical_person:
    type: boolean
    default: true
    restriction_mode: A
  password:
    type: string
    restriction_mode: G
  default_password:
    type: string
    restriction_mode: H
  can_change_own_password:
    type: boolean
    default: true
    restriction_mode: D
  gender:
    type: string
    restriction_mode: A
  email:
    type: string
    restriction_mode: E
  default_number:
    type: string
    restriction_mode: A
  default_structure_level:
    type: string
    restriction_mode: A
  default_vote_weight:
    type: decimal
    default: "1.000000"
    minimum: "0.000001"
    restriction_mode: A
  last_email_sent:
    type: timestamp
    restriction_mode: D
  is_demo_user:
    type: boolean
    restriction_mode: A
  last_login:
    type: timestamp
    restriction_mode: A
    read_only: true
  organization_management_level:
    type: string
    description: Hierarchical permission level for the whole organization.
    enum:
      - superadmin
      - can_manage_organization
      - can_manage_users
    restriction_mode: E

user_:
  entity_description:
    type: view
    table: userT
    table_letter: u
  is_present_in_meeting_ids:
    type: number[]
    to: meeting/present_user_ids
    restriction_mode: A
    Xsqlview: presence_user_in_meeting/meeting_id, where presence_user_in_meeting.user_id = id

  committee_ids:
    type: number[]
    restriction_mode: E
    description: Returns committee_ids, where the user is manager or member in a meeting
    select: >-
      select array_agg(committee_id) from (
          select m.committee_id as committee_id from group_to_user gtu
            join groupT g on g.id = gtu.group_id
            join meetingT m on m.id = g.meeting_id
            where gtu.user_id = u.id
          union
          select ctu.committee_id as committee_id from committee_to_user ctu where ctu.user_id = u.id
        ) as cs

  # for the motion forwarding
  forwarding_committee_ids:
    type: number[]
    restriction_mode: E
    Xsqlview: committee/id, where committee.forwarding_user_id = id

  meeting_user_ids:
    type: relation-list
    to: meeting_user/user_id
    restriction_mode: A
    os3_on_delete: CASCADE
  poll_voted_ids:
    type: number[]
    to: poll/voted_ids
    restriction_mode: A
    Xsqlview: poll_to_user/poll_id, where poll_to_user.user_id = id
  option_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: option/id, where option.content_user_id = id
  vote_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: vote/id, where vote.user_id = id
  delegated_vote_ids:
    type: number[]
    to: vote/delegated_user_id
    restriction_mode: A
    Xsqlview: vote/id, where vote.delegated_user_id = id
  poll_candidate_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: poll_candidate/id, where poll_candidate.user_id = id

  meeting_ids:
    type: number[]
    description: Calculated. All ids from meetings calculated via meeting_user and group_ids as integers.
    read_only: true
    restriction_mode: E
    todo: sqlview or backend calculated fields, but from userT, not view
    select: select array_agg(g.meeting_id) from group_to_user gtu join groupT g on g.id = gtu.group_id where gtu.user_id = u.id

committee_to_user:
  entity_description:
    type: table
  user_id:
    type: relation
    references: userT(id)
    required: true
  committee_id:
    type: relation
    references: committeeT(id)
    required: true

group_to_user:
  entity_description:
    type: table
  user_id:
    type: relation
    references: userT(id)
    required: true
  group_id:
    type: relation
    references: groupT(id)
    required: true

poll_to_user:
  entity_description:
    type: table
  user_id:
    type: relation
    references: userT(id)
    required: true
  poll_id:
    type: relation
    references: poll(id)
    required: true

presence_user_in_meeting:
  entity_description:
    type: table
    description: if exist, user is present in meeting. meeting_id and user_id together as unique primary key
  meeting_id:
    type: relation
    required: true
  user_id:
    type: relation
    required: true
  begin:
    type: timestamp
    required: true

meeting_user:
  entity_description:
    type: table
  id:
    type: number
    required: true
    restriction_mode: A

  comment:
    type: HTMLStrict
    restriction_mode: D
  number:
    type: string
    restriction_mode: A
  structure_level:
    type: string
    restriction_mode: A
  about_me:
    type: HTMLStrict
    restriction_mode: A
  vote_weight:
    type: decimal(6)
    minimum: "0.000001"
    restriction_mode: A

  user_id:
    type: relation
    to: user/meeting_user_ids
    references: userT(id)
    required: true
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/meeting_user_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

  personal_note_ids:
    type: relation-list
    to: personal_note/meeting_user_id
    equal_fields: meeting_id
    on_delete: CASCADE
    restriction_mode: B
  speaker_ids:
    type: relation-list
    to: speaker/meeting_user_id
    equal_fields: meeting_id
    restriction_mode: A
  supported_motion_ids:
    type: relation-list
    to: motion/supporter_meeting_user_ids
    equal_fields: meeting_id
    restriction_mode: A
  editor_for_motion_ids:
    type: relation-list
    to: motion/editor_id
    equal_fields: meeting_id
    restriction_mode: A
  working_group_speaker_for_motion_ids:
    type: relation-list
    to: motion/working_group_speaker_id
    equal_fields: meeting_id
    restriction_mode: A
  motion_submitter_ids:
    type: relation-list
    to: motion_submitter/meeting_user_id
    equal_fields: meeting_id
    on_delete: CASCADE
    restriction_mode: A
  assignment_candidate_ids:
    type: relation-list
    to: assignment_candidate/meeting_user_id
    equal_fields: meeting_id
    restriction_mode: A
  vote_delegated_to_id:
    type: relation
    to: meeting_user/vote_delegations_from_ids
    equal_fields: meeting_id
    restriction_mode: A
  vote_delegations_from_ids:
    type: relation-list
    to: meeting_user/vote_delegated_to_id
    equal_fields: meeting_id
    restriction_mode: A
  chat_message_ids:
    type: relation-list
    to: chat_message/meeting_user_id
    equal_fields: meeting_id
    restriction_mode: A
  group_ids:
    type: relation-list
    to: group/meeting_user_ids
    equal_fields: meeting_id
    restriction_mode: A

organization_tag:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: True
    restriction_mode: A
  color:
    type: color
    required: True
    restriction_mode: A

  tagged_ids:
    type: string[]
    to:
      collections:
        - committee
        - meeting
      field: organization_tag_ids
    restriction_mode: A
    Xsqlview: uses table organization_tag_to_committee_meeting to construct a list of fqids where this tag is used

organization_tag_to_committee_meeting:
    entity_description:
      type: table
      todo: one of meeting_id or committee_required, other empty
    organization_tag_id:
      type: number
      references: organization_tag(id)
      required: true
    meeting_id:
      type: number
      references: meetingT(id)
    committee_id:
      type: number
      references: committeeT(id)

theme:
  entity_description:
    type: table
  id:
    restriction_mode: A
    type: number
    required: true
  name:
    restriction_mode: A
    type: string
    required: true
  accent_100:
    restriction_mode: A
    type: color
  accent_200:
    restriction_mode: A
    type: color
  accent_300:
    restriction_mode: A
    type: color
  accent_400:
    restriction_mode: A
    type: color
  accent_50:
    restriction_mode: A
    type: color
  accent_500:
    restriction_mode: A
    type: color
    required: true
  accent_600:
    restriction_mode: A
    type: color
  accent_700:
    restriction_mode: A
    type: color
  accent_800:
    restriction_mode: A
    type: color
  accent_900:
    restriction_mode: A
    type: color
  accent_a100:
    restriction_mode: A
    type: color
  accent_a200:
    restriction_mode: A
    type: color
  accent_a400:
    restriction_mode: A
    type: color
  accent_a700:
    restriction_mode: A
    type: color
  primary_100:
    restriction_mode: A
    type: color
  primary_200:
    restriction_mode: A
    type: color
  primary_300:
    restriction_mode: A
    type: color
  primary_400:
    restriction_mode: A
    type: color
  primary_50:
    restriction_mode: A
    type: color
  primary_500:
    restriction_mode: A
    type: color
    required: true
  primary_600:
    restriction_mode: A
    type: color
  primary_700:
    restriction_mode: A
    type: color
  primary_800:
    restriction_mode: A
    type: color
  primary_900:
    restriction_mode: A
    type: color
  primary_a100:
    restriction_mode: A
    type: color
  primary_a200:
    restriction_mode: A
    type: color
  primary_a400:
    restriction_mode: A
    type: color
  primary_a700:
    restriction_mode: A
    type: color
  warn_100:
    restriction_mode: A
    type: color
  warn_200:
    restriction_mode: A
    type: color
  warn_300:
    restriction_mode: A
    type: color
  warn_400:
    restriction_mode: A
    type: color
  warn_50:
    restriction_mode: A
    type: color
  warn_500:
    restriction_mode: A
    type: color
    required: true
  warn_600:
    restriction_mode: A
    type: color
  warn_700:
    restriction_mode: A
    type: color
  warn_800:
    restriction_mode: A
    type: color
  warn_900:
    restriction_mode: A
    type: color
  warn_a100:
    restriction_mode: A
    type: color
  warn_a200:
    restriction_mode: A
    type: color
  warn_a400:
    restriction_mode: A
    type: color
  warn_a700:
    restriction_mode: A
    type: color
  headbar:
    restriction_mode: A
    type: color
  "yes":
    restriction_mode: A
    type: color
  "no":
    restriction_mode: A
    type: color
  abstain:
    restriction_mode: A
    type: color

committeeT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  description:
    type: HTMLStrict
    restriction_mode: A
  external_id:
    type: string
    restriction_mode: A
    description: unique
  meeting_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: meeting/id, where meeting.committee_id = id
  default_meeting_id:
    type: relation
    to: meeting/default_meeting_for_committee_id
    references: meetingT(id)
    restriction_mode: A
  forwarding_user_id:
    type: relation
    to: user/forwarding_committee_ids
    references: userT(id)
    restriction_mode: B

committee:
  entity_description:
    type: view
    table: committeeT
    table_letter: c
  forward_to_committee_ids:
    type: number[]
    restriction_mode: B
    select: "select array_agg(f.receiving_committee_id) from forwarding_committee_to_committee f where f.forwarding_committee_id = c.id"
  receive_from_committee_ids:
    type: number[]
    restriction_mode: B
    select: "select array_agg(f.forwarding_committee_id) from forwarding_committee_to_committee f where f.receiving_committee_id = c.id"
  user_ids:
    type: number[]
    restriction_mode: A
    select: >-
      select array_agg(user_id) from (
        select gtu.user_id as user_id from meetingT m
          join groupT g on g.meeting_id = m.id
          join group_to_user gtu on gtu.group_id = g.id
          where m.committee_id = c.id
        union
        select ctu.user_id as user_id from committee_to_user ctu where ctu.committee_id = c.id
      ) as x
  meeting_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: meeting/id, where meeting.committee_id = id
  manager_ids:
    type: number[]
    to: user/committee_management_ids
    restriction_mode: B
    sqlview TODO: user/id; where IMO with groups, but still not designed
  organization_tag_ids:
    type: number[]
    to: organization_tag/tagged_ids
    restriction_mode: A
    Xsqlview: organization_tag/id, where organization_tag_to_committee_meeting.committee_id = id join organization_tag_to_committee_meeting.organization_tag_id = organization_tag.id


forwarding_committee_to_committee:
  entity_description:
    type: table
  forwarding_committee_id:
    type: relation
    required: True
    references: committeeT(id)
    on_delete: CASCADE
  receiving_committee_id:
    type: relation
    required: True
    references: committeeT(id)
    on_delete: CASCADE

meetingT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  external_id:
    type: string
    restriction_mode: A
    description: unique in committee
  welcome_title:
    type: string
    default: Welcome to OpenSlides
    restriction_mode: C
  welcome_text:
    type: HTMLPermissive
    default: Space for your welcome text.
    restriction_mode: C

  # General
  name:
    type: string
    maxLength: 100
    default: OpenSlides
    restriction_mode: A
    required: true
  state:
    type: string
    enum:
      - active
      - archived
    default: active
    indexed: true
    restriction_mode: A
  description:
    type: string
    maxLength: 100
    default: Presentation and assembly system
    restriction_mode: B
  location:
    type: string
    restriction_mode: B
  start_time:
    type: timestamp
    restriction_mode: B
  end_time:
    type: timestamp
    restriction_mode: B
  imported_at:
    type: timestamp
    restriction_mode: B
  language:
    type: string
    restriction_mode: A
    enum:
      - en
      - de
      - it
      - es
      - ru
      - cs
    required: true

  # Configuration (only for the server owner)
  jitsi_domain:
    type: string
    restriction_mode: B
  jitsi_room_name:
    type: string
    restriction_mode: B
  jitsi_room_password:
    type: string
    restriction_mode: B

  # System
  template_for_organization:
    type: boolean
    default: false
    restriction_mode: B
  enable_anonymous:
    type: boolean
    default: False
    restriction_mode: A
  custom_translations:
    type: JSON
    restriction_mode: B

  # Jitsi/Livestream settings
  conference_show:
    type: boolean
    default: False
    restriction_mode: C
  conference_auto_connect:
    type: boolean
    default: False
    restriction_mode: C
  conference_los_restriction:
    type: boolean
    default: True
    restriction_mode: C
  conference_stream_url:
    type: string
    restriction_mode: C
  conference_stream_poster_url:
    type: string
    restriction_mode: C
  conference_open_microphone:
    type: boolean
    default: False
    restriction_mode: C
  conference_open_video:
    type: boolean
    default: False
    restriction_mode: C
  conference_auto_connect_next_speakers:
    type: number
    default: 0
    restriction_mode: C
  conference_enable_helpdesk:
    type: boolean
    default: False
    restriction_mode: C
  applause_enable:
    type: boolean
    default: False
    restriction_mode: C
  applause_type:
    type: string
    enum:
      - applause-type-bar
      - applause-type-particles
    default: applause-type-bar
    restriction_mode: C
  applause_show_level:
    type: boolean
    default: False
    restriction_mode: C
  applause_min_amount:
    type: number
    default: 1
    minimum: 0
    restriction_mode: C
  applause_max_amount:
    type: number
    default: 0
    minimum: 0
    restriction_mode: C
  applause_timeout:
    type: number
    default: 5
    minimum: 0
    restriction_mode: C
  applause_particle_image_url:
    type: string
    restriction_mode: C

  # Projector countdown
  projector_countdown_default_time:
    type: number
    default: 60
    required: true
    restriction_mode: B
  projector_countdown_warning_time:
    type: number
    minimum: 0
    default: 0
    required: true
    restriction_mode: B

  # Exports
  export_csv_encoding:
    type: string
    enum:
      - utf-8
      - iso-8859-15
    default: utf-8
    restriction_mode: B
  export_csv_separator:
    type: string
    default: ";"
    restriction_mode: B
  export_pdf_pagenumber_alignment:
    type: string
    enum:
      - left
      - right
      - center
    default: center
    restriction_mode: B
  export_pdf_fontsize:
    type: number
    enum:
      - 10
      - 11
      - 12
    default: 10
    restriction_mode: B
  export_pdf_line_height:
    type: float
    default: 1.25
    minimum: 1.0
    restriction_mode: B
  export_pdf_page_margin_left:
    type: number
    default: 20
    minimum: 0
    restriction_mode: B
  export_pdf_page_margin_top:
    type: number
    default: 25
    minimum: 0
    restriction_mode: B
  export_pdf_page_margin_right:
    type: number
    default: 20
    minimum: 0
    restriction_mode: B
  export_pdf_page_margin_bottom:
    type: number
    default: 20
    minimum: 0
    restriction_mode: B
  export_pdf_pagesize:
    type: string
    enum:
      - A4
      - A5
    default: A4
    restriction_mode: B

  # Agenda
  agenda_show_subtitles:
    type: boolean
    default: False
    restriction_mode: B
  agenda_enable_numbering:
    type: boolean
    default: True
    restriction_mode: B
  agenda_number_prefix:
    type: string
    maxLength: 20
    restriction_mode: B
  agenda_numeral_system:
    type: string
    enum:
      - arabic
      - roman
    default: arabic
    restriction_mode: B
  agenda_item_creation:
    type: string
    enum:
      - always
      - never
      - default_yes
      - default_no
    default: default_no
    restriction_mode: B
  agenda_new_items_default_visibility:
    type: string
    enum:
      - common
      - internal
      - hidden
    default: internal
    restriction_mode: B
  agenda_show_internal_items_on_projector:
    type: boolean
    default: False
    restriction_mode: B

  # List of speakers
  list_of_speakers_amount_last_on_projector:
    type: number
    minimum: -1
    default: 0
    restriction_mode: B
  list_of_speakers_amount_next_on_projector:
    type: number
    minimum: -1
    default: -1
    restriction_mode: B
  list_of_speakers_couple_countdown:
    type: boolean
    default: True
    restriction_mode: B
  list_of_speakers_show_amount_of_speakers_on_slide:
    type: boolean
    default: True
    restriction_mode: B
  list_of_speakers_present_users_only:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_show_first_contribution:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_enable_point_of_order_speakers:
    type: boolean
    default: True
    restriction_mode: B
  list_of_speakers_enable_point_of_order_categories:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_closing_disables_point_of_order:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_enable_pro_contra_speech:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_can_set_contribution_self:
    type: boolean
    default: False
    restriction_mode: B
  list_of_speakers_speaker_note_for_everyone:
    type: boolean
    default: True
    restriction_mode: B
  list_of_speakers_initially_closed:
    type: boolean
    default: False
    restriction_mode: B

  # Motions
  motions_default_workflow_id:
    type: relation
    references: motion_workflow(id)
    on_delete: RESTRICT
    required: true
    deferred_foreign_key: true
    restriction_mode: B
  motions_default_amendment_workflow_id:
    type: relation
    references: motion_workflow(id)
    on_delete: RESTRICT
    required: true
    deferred_foreign_key: true
    restriction_mode: B
  motions_default_statute_amendment_workflow_id:
    type: relation
    references: motion_workflow(id)
    on_delete: RESTRICT
    required: true
    deferred_foreign_key: true
    restriction_mode: B
  motions_preamble:
    type: text
    default: "The assembly may decide:"
    restriction_mode: B
  motions_default_line_numbering:
    type: string
    enum:
      - outside
      - inline
      - none
    default: outside
    restriction_mode: B
  motions_line_length:
    type: number
    minimum: 40
    default: 85
    restriction_mode: B
  motions_reason_required:
    type: boolean
    default: False
    restriction_mode: B
  motions_enable_text_on_projector:
    type: boolean
    default: True
    restriction_mode: B
  motions_enable_reason_on_projector:
    type: boolean
    default: False
    restriction_mode: B
  motions_enable_sidebox_on_projector:
    type: boolean
    default: False
    restriction_mode: B
  motions_enable_recommendation_on_projector:
    type: boolean
    default: True
    restriction_mode: B
  motions_show_referring_motions:
    type: boolean
    default: True
    restriction_mode: B
  motions_show_sequential_number:
    type: boolean
    default: True
    restriction_mode: B
  motions_recommendations_by:
    type: string
    restriction_mode: B
  motions_block_slide_columns:
    type: number
    minimum: 1
    restriction_mode: B
  motions_statute_recommendations_by:
    type: string
    restriction_mode: B
  motions_recommendation_text_mode:
    type: string
    enum:
      - original
      - changed
      - diff
      - agreed
    default: diff
    restriction_mode: B
  motions_default_sorting:
    type: string
    enum:
      - number
      - weight
    default: number
    restriction_mode: B
  motions_number_type:
    type: string
    enum:
      - per_category
      - serially_numbered
      - manually
    default: per_category
    restriction_mode: B
  motions_number_min_digits:
    type: number
    default: 2
    restriction_mode: B
  motions_number_with_blank:
    type: boolean
    default: False
    restriction_mode: B
  motions_statutes_enabled:
    type: boolean
    default: False
    restriction_mode: B
  motions_amendments_enabled:
    type: boolean
    default: True
    restriction_mode: B
  motions_amendments_in_main_list:
    type: boolean
    default: True
    restriction_mode: B
  motions_amendments_of_amendments:
    type: boolean
    default: False
    restriction_mode: B
  motions_amendments_prefix:
    type: string
    default: "-Ã„"
    restriction_mode: B
  motions_amendments_text_mode:
    type: string
    enum:
      - freestyle
      - fulltext
      - paragraph
    default: paragraph
    restriction_mode: B
  motions_amendments_multiple_paragraphs:
    type: boolean
    default: True
    restriction_mode: B
  motions_supporters_min_amount:
    type: number
    minimum: 0
    default: 0
    restriction_mode: B
  motions_enable_editor:
    type: boolean
    restriction_mode: B
  motions_enable_working_group_speaker:
    type: boolean
    restriction_mode: B
  motions_export_title:
    type: string
    default: Motions
    restriction_mode: B
  motions_export_preamble:
    type: text
    restriction_mode: B
  motions_export_submitter_recommendation:
    type: boolean
    default: True
    restriction_mode: B
  motions_export_follow_recommendation:
    type: boolean
    default: False
    restriction_mode: B

  # Motion poll
  motion_poll_ballot_paper_selection:
    type: string
    enum:
      - NUMBER_OF_DELEGATES
      - NUMBER_OF_ALL_PARTICIPANTS
      - CUSTOM_NUMBER
    default: CUSTOM_NUMBER
    restriction_mode: B
  motion_poll_ballot_paper_number:
    type: number
    default: 8
    restriction_mode: B
  motion_poll_default_type:
    type: string
    default: pseudoanonymous
    restriction_mode: B
  motion_poll_default_onehundred_percent_base:
    type: string
    default: YNA
    restriction_mode: B
  motion_poll_default_backend:
    type: string
    default: fast
    enum:
      - long
      - fast
    restriction_mode: B

  # Users
  users_enable_presence_view:
    type: boolean
    default: False
    restriction_mode: B
  users_enable_vote_weight:
    type: boolean
    default: False
    restriction_mode: B
  users_allow_self_set_present:
    type: boolean
    default: True
    restriction_mode: B
  users_pdf_welcometitle:
    type: string
    default: Welcome to OpenSlides
    restriction_mode: B
  users_pdf_welcometext:
    type: text
    default: "[Place for your welcome and help text.]"
    restriction_mode: B
  users_pdf_wlan_ssid:
    type: string
    restriction_mode: B
  users_pdf_wlan_password:
    type: string
    restriction_mode: B
  users_pdf_wlan_encryption:
    type: string
    default: WPA
    enum:
      - ""
      - WEP
      - WPA
      - nopass
    restriction_mode: B
  users_email_sender:
    type: string
    default: OpenSlides
    restriction_mode: B
  users_email_replyto:
    type: string
    restriction_mode: B
  users_email_subject:
    type: string
    default: OpenSlides access data
    restriction_mode: B
  users_email_body:
    type: text
    default: >-
      Dear {name},


      this is your personal OpenSlides login:


      {url}

      Username: {username}

      Password: {password}



      This email was generated automatically.
    restriction_mode: B
  users_enable_vote_delegations:
    type: boolean
    restriction_mode: B

  # Assignments
  assignments_export_title:
    type: string
    default: Elections
    restriction_mode: B
  assignments_export_preamble:
    type: text
    restriction_mode: B

  # Assignment polls
  assignment_poll_ballot_paper_selection:
    type: string
    enum:
      - NUMBER_OF_DELEGATES
      - NUMBER_OF_ALL_PARTICIPANTS
      - CUSTOM_NUMBER
    default: CUSTOM_NUMBER
    restriction_mode: B
  assignment_poll_ballot_paper_number:
    type: number
    default: 8
    restriction_mode: B
  assignment_poll_add_candidates_to_list_of_speakers:
    type: boolean
    default: False
    restriction_mode: B
  assignment_poll_enable_max_votes_per_option:
    type: boolean
    default: False
    restriction_mode: B
  assignment_poll_sort_poll_result_by_votes:
    type: boolean
    default: True
    restriction_mode: B
  assignment_poll_default_type:
    type: string
    default: pseudoanonymous
    restriction_mode: B
  assignment_poll_default_method:
    type: string
    default: Y
    restriction_mode: B
  assignment_poll_default_onehundred_percent_base:
    type: string
    default: valid
    restriction_mode: B
  assignment_poll_default_backend:
    type: string
    default: fast
    enum:
      - long
      - fast
    restriction_mode: B

  # Polls
  poll_ballot_paper_selection:
    type: string
    enum:
      - NUMBER_OF_DELEGATES
      - NUMBER_OF_ALL_PARTICIPANTS
      - CUSTOM_NUMBER
    restriction_mode: B
  poll_ballot_paper_number:
    type: number
    restriction_mode: B
  poll_sort_poll_result_by_votes:
    type: boolean
    restriction_mode: B
  poll_default_type:
    type: string
    default: analog
    restriction_mode: B
  poll_default_method:
    type: string
    restriction_mode: B
  poll_default_onehundred_percent_base:
    type: string
    default: YNA
    restriction_mode: B
  poll_default_backend:
    type: string
    default: fast
    enum:
      - long
      - fast
    restriction_mode: B
  poll_couple_countdown:
    type: boolean
    default: True
    restriction_mode: B

  # Topic poll
  topic_poll_default_group_ids:
    type: relation-list
    to: group/used_as_topic_poll_default_id
    restriction_mode: B

  # Relations
  projector_ids:
    type: relation-list
    to: projector/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  all_projection_ids:
    type: relation-list
    to: projection/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  projector_message_ids:
    type: relation-list
    to: projector_message/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  projector_countdown_ids:
    type: relation-list
    to: projector_countdown/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  tag_ids:
    type: relation-list
    to: tag/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  agenda_item_ids:
    type: relation-list
    to: agenda_item/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  list_of_speakers_ids:
    type: relation-list
    to: list_of_speakers/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  point_of_order_category_ids:
    type: relation-list
    to: point_of_order_category/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  speaker_ids:
    type: relation-list
    to: speaker/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  topic_ids:
    type: relation-list
    to: topic/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  group_ids:
    type: relation-list
    to: group/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  mediafile_ids:
    type: relation-list
    to: mediafile/owner_id
    on_delete: CASCADE
    restriction_mode: B
  motion_ids:
    type: relation-list
    to: motion/meeting_id
    on_delete: CASCADE
    restriction_mode: A
  forwarded_motion_ids:
    type: relation-list
    to: motion/origin_meeting_id
    on_delete: CASCADE
    restriction_mode: A
  motion_comment_section_ids:
    type: relation-list
    to: motion_comment_section/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_category_ids:
    type: relation-list
    to: motion_category/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_block_ids:
    type: relation-list
    to: motion_block/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_workflow_ids:
    type: relation-list
    to: motion_workflow/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_statute_paragraph_ids:
    type: relation-list
    to: motion_statute_paragraph/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_comment_ids:
    type: relation-list
    to: motion_comment/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_submitter_ids:
    type: relation-list
    to: motion_submitter/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_change_recommendation_ids:
    type: relation-list
    to: motion_change_recommendation/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  motion_state_ids:
    type: relation-list
    to: motion_state/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  poll_ids:
    type: relation-list
    to: poll/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  option_ids:
    type: relation-list
    to: option/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  vote_ids:
    type: relation-list
    to: vote/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  assignment_ids:
    type: relation-list
    to: assignment/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  assignment_candidate_ids:
    type: relation-list
    to: assignment_candidate/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  personal_note_ids:
    type: relation-list
    to: personal_note/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  chat_group_ids:
    type: relation-list
    to: chat_group/meeting_id
    on_delete: CASCADE
    restriction_mode: B
  chat_message_ids:
    type: relation-list
    to: chat_message/meeting_id
    on_delete: CASCADE
    restriction_mode: B

  # Logos and Fonts
  logo_projector_main_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_projector_header_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_web_header_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_pdf_header_l_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_pdf_header_r_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_pdf_footer_l_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_pdf_footer_r_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  logo_pdf_ballot_paper_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_regular_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_italic_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_bold_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_bold_italic_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_monospace_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_chyron_speaker_name_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_projector_h1_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B
  font_projector_h2_id:
    type: relation
    references: mediafile(id)
    restriction_mode: B

  # Other relations
  committee_id:
    type: relation
    references: committeeT(id)
    required: true
    restriction_mode: B
  reference_projector_id:
    type: relation
    references: projector(id)
    deferred_foreign_key: true
    required: true
    restriction_mode: B
  default_group_id:
    type: relation
    references: groupT(id)
    deferred_foreign_key: true
    required: true
    restriction_mode: B
  admin_group_id:
    type: relation
    references: groupT(id)
    deferred_foreign_key: true
    restriction_mode: B

meeting:
  entity_description:
    type: view
    table: meetingT
    table_letter: m
  # Motion poll
  motion_poll_default_group_ids:
    type: number[]
    to: group/used_as_motion_poll_default_id
    restriction_mode: B
    Xsqlview: group/id, where group.used_as_motion_poll_default_id = id

  # poll list election
  poll_candidate_list_ids:
    type: number[]
    to: poll_candidate_list/meeting_id
    restriction_mode: B
    Xsqlview: poll_candidate_list/id; where poll_candidate_list.meeting_id = id
  poll_candidate_ids:
    type: number[]
    to: poll_candidate/meeting_id
    restriction_mode: B
    Xsqlview: poll_candidate/id, where poll_candidate.meeting_id = id

  # Users
  meeting_user_ids:
    type: number[]
    restriction_mode: B
    os3_on_delete: CASCADE
    Xsqlview: meeting_user/id, where meeting_user.meeting_id = id

  # Assignment polls
  assignment_poll_default_group_ids:
    type: number[]
    to: group/used_as_assignment_poll_default_id
    restriction_mode: B
    Xsqlview: group/id, where group.used_as_assignment_poll_default_id = id

  # Polls
  poll_default_group_ids:
    type: number[]
    to: group/used_as_poll_default_id
    restriction_mode: B
    Xsqlview: group/id, where group.used_as_poll_default_id = id

  # Topic poll
  topic_poll_default_group_ids:
    type: number[]
    to: group/used_as_topic_poll_default_id
    restriction_mode: B
    Xsqlview: group/id, where group.used_as_topic_poll_default_id = id

  # Relations
  projector_ids:
    type: number[]
    to: projector/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: projector/id, where meeting_id = id
  all_projection_ids:
    type: number[]
    to: projection/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: projection/id, where meeting_id = id
  projector_message_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: projector_message/id, where projector_message.meeting_id = id
  projector_countdown_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: projector_countdown/id, where projector_countdown.meeting_id = id
  tag_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: tag/id, where tag.meeting_id = id
  agenda_item_ids:
    type: relation-list
    restriction_mode: B
    Xsqlview: agenda_item/id, where agenda_item.meeting_id = id
  list_of_speakers_ids:
    type: relation-list
    to: list_of_speakers/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: list_of_speakers/id, where meeting_id = id
  speaker_ids:
    type: relation-list
    to: speaker/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: speaker/id, where meeting_id = id
  topic_ids:
    type: relation-list
    to: topic/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: topic/id, where meeting_id = id
  group_ids:
    type: relation-list
    to: group/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: group/id, where meeting_id = id
  mediafile_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: mediafile/id, where mediafile.owner_meeting_id = id
  motion_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: motion/id, where motion.meeting_id = id
  forwarded_motion_ids:
    type: relation-list
    to: motion/origin_meeting_id
    os3_on_delete: CASCADE
    restriction_mode: A
    Xsqlview: motion/id, where origin_meeting_id = id
  motion_comment_section_ids:
    type: relation-list
    to: motion_comment_section/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_comment_section/id, where meeting_id = id
  motion_category_ids:
    type: relation-list
    to: motion_category/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_category/id, where meeting_id = id
  motion_block_ids:
    type: relation-list
    to: motion_block/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_block/id, where meeting_id = id
  motion_workflow_ids:
    type: relation-list
    to: motion_workflow/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_workflow/id, where meeting_id = id
  motion_statute_paragraph_ids:
    type: relation-list
    to: motion_statute_paragraph/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_statute_paragraph/id, where meeting_id = id
  motion_comment_ids:
    type: relation-list
    to: motion_comment/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_comment/id, where meeting_id = id
  motion_submitter_ids:
    type: relation-list
    to: motion_submitter/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_submitter/id, where meeting_id = id
  motion_change_recommendation_ids:
    type: relation-list
    to: motion_change_recommendation/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_change_recommendation/id, where meeting_id = id
  motion_state_ids:
    type: relation-list
    to: motion_state/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: motion_state/id, where meeting_id = id
  poll_ids:
    type: relation-list
    to: poll/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: poll/id, where meeting_id = id
  option_ids:
    type: relation-list
    to: option/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: option/id, where meeting_id = id
  vote_ids:
    type: relation-list
    to: vote/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: vote/id, where meeting_id = id
  assignment_ids:
    type: relation-list
    to: assignment/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: assignment/id, where meeting_id = id
  assignment_candidate_ids:
    type: relation-list
    to: assignment_candidate/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: assignment_candidate/id, where meeting_id = id
  personal_note_ids:
    type: relation-list
    to: personal_note/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: personal_note/id, where meeting_id = id
  chat_group_ids:
    type: relation-list
    to: chat_group/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: chat_group/id, where meeting_id = id
  chat_message_ids:
    type: relation-list
    to: chat_message/meeting_id
    os3_on_delete: CASCADE
    restriction_mode: B
    Xsqlview: chat_message/id, where meeting_id = id

  # Other relations
  organization_tag_ids:
    type: number[]
    to: organization_tag/tagged_ids
    restriction_mode: B
    Xsqlview: organization_tag/id, where organization_tag_to_committee_meeting.meeting_id = id join organization_tag_to_committee_meeting.organization_tag_id = organization_tag.id
  present_user_ids:
    type: number[]
    restriction_mode: B
    Xsqlview: presence_user_in_meeting/user_id, where presence_user_in_meeting.meeting_id = id
  user_ids:
    type: number[]
    description: Calculated. All user ids from all users assigned to groups of this meeting.
    read_only: true
    restriction_mode: B
    select: select array_agg(gtu.user_id) from groupT g join group_to_user gtu on gtu.group_id = g.id where g.meeting_id = m.id
    Xsqlview: user/id, where ...
  list_of_speakers_countdown_id:
    type: number
    restriction_mode: B
    Xsqlview: projector_countdown/id, where projector_countdown.used_as_list_of_speakers_countdown_meeting_id = id
  poll_countdown_id:
    type: number
    restriction_mode: B
    Xsqlview: projector_countdown/id, where projector_countdown.used_as_poll_countdown_meeting_id = id
  projection_ids:
    type: number[]
    to: projection/content_object_id
    os3_on_delete: CASCADE
    restriction_mode: B
  default_projector_agenda_item_list_ids:
    type: relation-list
    to: projector/used_as_default_projector_for_agenda_item_list_in_meeting_id
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_agenda_all_items_in_meeting_id = id
  default_projector_topics_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_topics_in_meeting_id = id
  default_projector_list_of_speakers_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_list_of_speakers_in_meeting_id = id
  default_projector_current_list_of_speakers_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_cur_list_of_speakers_in_meeting_id = id
  default_projector_motion_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_motion_in_meeting_id = id
  default_projector_amendment_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_amendment_in_meeting_id = id
  default_projector_motion_block_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_motion_block_in_meeting_id = id
  default_projector_assignment_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_assignment_in_meeting_id = id
  default_projector_mediafile_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_mediafile_in_meeting_id = id
  default_projector_projector_message_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_projector_message_in_meeting_id = id
  default_projector_projector_countdowns_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_projector_countdowns_in_meeting_id = id
  default_projector_assignment_poll_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_assignment_poll_in_meeting_id = id
  default_projector_motion_poll_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_motion_poll_in_meeting_id = id
  default_projector_poll_ids:
    type: number[]
    restriction_mode: B
    required: true
    Xsqlview: projector/id, where projector.used_as_default_projector_for_poll_in_meeting_id = id

groupT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  external_id:
    type: string
    restriction_mode: A
    description: unique in meeting
  name:
    type: string
    required: true
    restriction_mode: A
  permissions:
    type: string[]
    items:
      enum:
        - agenda_item.can_manage
        - agenda_item.can_see
        - agenda_item.can_see_internal
        - assignment.can_manage
        - assignment.can_nominate_other
        - assignment.can_nominate_self
        - assignment.can_see
        - chat.can_manage
        - list_of_speakers.can_be_speaker
        - list_of_speakers.can_manage
        - list_of_speakers.can_see
        - mediafile.can_manage
        - mediafile.can_see
        - meeting.can_manage_logos_and_fonts
        - meeting.can_manage_settings
        - meeting.can_see_autopilot
        - meeting.can_see_frontpage
        - meeting.can_see_history
        - meeting.can_see_livestream
        - motion.can_create
        - motion.can_create_amendments
        - motion.can_forward
        - motion.can_manage
        - motion.can_manage_metadata
        - motion.can_manage_polls
        - motion.can_see
        - motion.can_see_internal
        - motion.can_support
        - poll.can_manage
        - projector.can_manage
        - projector.can_see
        - tag.can_manage
        - user.can_manage
        - user.can_manage_presence
        - user.can_see
    restriction_mode: A
  weight:
    type: number
    restriction_mode: A

  mediafile_access_group_ids:
    type: relation-list
    to: mediafile/access_group_ids
    equal_fields: meeting_id
    restriction_mode: A
  mediafile_inherited_access_group_ids:
    type: relation-list
    to: mediafile/inherited_access_group_ids
    description: Calculated field.
    read_only: true
    restriction_mode: A
  read_comment_section_ids:
    type: relation-list
    to: motion_comment_section/read_group_ids
    equal_fields: meeting_id
    restriction_mode: A
  write_comment_section_ids:
    type: relation-list
    to: motion_comment_section/write_group_ids
    equal_fields: meeting_id
    restriction_mode: A
  poll_ids:
    type: relation-list
    to: poll/entitled_group_ids
    equal_fields: meeting_id
    restriction_mode: A
  used_as_motion_poll_default_id:
    type: relation
    references: meetingT(id)
    on_delete: CASCADE
    to: meeting/motion_poll_default_group_ids
    restriction_mode: A
  used_as_assignment_poll_default_id:
    type: relation
    references: meetingT(id)
    to: meeting/assignment_poll_default_group_ids
    restriction_mode: A
  used_as_topic_poll_default_id:
    type: relation
    references: meetingT(id)
    to: meeting/topic_poll_default_group_ids
    restriction_mode: A
  used_as_poll_default_id:
    type: relation
    references: meetingT(id)
    to: meeting/poll_default_group_ids
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/group_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

group_:
  entity_description:
    type: view
    table: groupT
    table_letter: g
  meeting_user_ids:
    type: number[]
    restriction_mode: A
    equal_fields: meeting_id
    Xsqlview: select array_agg(m.id) from meeting_user m where m.group_id = g.id
  default_group_for_meeting_id:
    type: number
    restriction_mode: A
    select: select m.id from meetingT m where m.default_group_id = g.id
  admin_group_for_meeting_id:
    type: number
    restriction_mode: A
    select: select m.id from meetingT m where m.admin_group_id = g.id
  read_chat_group_ids:
    type: number[]
    restriction_mode: A
    select: select array_agg(gtg.chat_group_id) from chat_group_to_group gtg where gtg.group_id = g.id and gtg.read
  write_chat_group_ids:
    type: number[]
    restriction_mode: A
    select: select array_agg(gtg.chat_group_id) from chat_group_to_group gtg where gtg.group_id = g.id and gtg.write

personal_note:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  note:
    type: HTMLStrict
    restriction_mode: A
  star:
    type: boolean
    restriction_mode: A
  user_id:
    type: relation
    to: meeting_user/personal_note_ids
    equal_fields: meeting_id
    restriction_mode: A
    required: true
  motion_id:
    type: relation
    references: motionT(id)
    restriction_mode: A
    todo: more content_objects possible, 0 or 1 allowed
  meeting_id:
    type: relation
    references: meetingT(id)
    required: true
    restriction_mode: A

tag:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A

  tagged_ids:
    type: generic-relation-list
    to:
      collections:
        - agenda_item
        - assignment
        - motion
      field: tag_ids
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/tag_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

agenda_item:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  item_number:
    type: string
    restriction_mode: A
  comment:
    type: string
    restriction_mode: C
  closed:
    type: boolean
    default: false
    restriction_mode: A
  type:
    type: string
    enum:
      - common
      - internal
      - hidden
    default: common
    restriction_mode: A
  duration:
    type: number
    description: Given in seconds
    minimum: 0
    restriction_mode: B
  is_internal:
    type: boolean
    description: Calculated by the server
    read_only: true
    restriction_mode: A
  is_hidden:
    type: boolean
    description: Calculated by the server
    read_only: true
    restriction_mode: A
  level:
    type: number
    description: Calculated by the server
    read_only: true
    restriction_mode: A
  weight:
    type: number
    restriction_mode: A

  content_object_id:
    type: generic-relation
    to:
      collections:
        - motion
        - motion_block
        - assignment
        - topic
      field: agenda_item_id
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  parent_id:
    type: relation
    references: agenda_item(id)
    equal_fields: meeting_id
    restriction_mode: A
  tag_ids:
    type: relation-list
    to: tag/tagged_ids
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_agenda_item_id = id
  meeting_id:
    type: relation
    to: meeting/agenda_item_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

list_of_speakers:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  closed:
    type: boolean
    default: false
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  content_object_id:
    type: generic-relation
    to:
      collections:
        - motion
        - motion_block
        - assignment
        - topic
        - mediafile
      field: list_of_speakers_id
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  speaker_ids:
    type: relation-list
    to: speaker/list_of_speakers_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_list_of_speakers_id = id
  meeting_id:
    type: relation
    to: meeting/list_of_speakers_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

point_of_order_category:
  id:
    type: number
    restriction_mode: A
  text:
    type: string
    required: true
    restriction_mode: A
  rank:
    type: number
    required: true
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/point_of_order_category_ids
    required: true
    restriction_mode: A
  speaker_ids:
    type: relation-list
    to: speaker/point_of_order_category_id
    equal_fields: meeting_id
    restriction_mode: A

speaker:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  begin_time:
    type: timestamp
    read_only: true
    restriction_mode: A
  end_time:
    type: timestamp
    read_only: true
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  speech_state:
    type: string
    enum:
      - contribution
      - pro
      - contra
    restriction_mode: A
  note:
    type: string
    maxLength: 250
    restriction_mode: A
  point_of_order:
    type: boolean
    restriction_mode: A
  list_of_speakers_id:
    type: relation
    to: list_of_speakers/speaker_ids
    references: list_of_speakers(id)
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  user_id:
    type: relation
    to: meeting_user/speaker_ids
    equal_fields: meeting_id
    restriction_mode: A
  point_of_order_category_id:
    type: relation
    to: point_of_order_category/speaker_ids
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/speaker_ids
    required: true
    restriction_mode: A

topic:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  text:
    type: HTMLPermissive
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  attachment_ids:
    type: relation-list
    to: mediafile/attachment_ids
    equal_fields: meeting_id
    restriction_mode: A
  agenda_item_id:
    type: relation
    to: agenda_item/content_object_id
    references: agenda_item(id)
    required: true
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  list_of_speakers_id:
    type: relation
    to: list_of_speakers/content_object_id
    references: list_of_speakers(id)
    required: true
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  poll_ids:
    type: relation-list
    to: poll/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_topic_id = id
  meeting_id:
    type: relation
    to: meeting/topic_ids
    references: meetingT(id)
    required: true
    restriction_mode: A

motionT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  number:
    type: string
    restriction_mode: C
  number_value:
    type: number
    description: The number value of this motion. This number is auto-generated and read-only.
    read_only: true
    restriction_mode: D
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: C
  title:
    type: string
    required: true
    restriction_mode: C
  text:
    type: HTMLStrict
    restriction_mode: C
  amendment_paragraphs:
    type: JSON
    restriction_mode: C
  modified_final_version:
    type: HTMLStrict
    restriction_mode: C
  reason:
    type: HTMLStrict
    restriction_mode: C
  category_weight:
    type: number
    default: 10000
    restriction_mode: C
  state_extension:
    type: string
    restriction_mode: C
  recommendation_extension:
    type: string
    restriction_mode: C
  sort_weight:
    type: number
    default: 10000
    restriction_mode: C
  created:
    type: timestamp
    restriction_mode: C
  last_modified:
    type: timestamp
    read_only: true
    restriction_mode: C
  workflow_timestamp:
    type: timestamp
    read_only: true
    restriction_mode: C
  start_line_number:
    type: number
    restriction_mode: C
    minimum: 1
    default: 1
  forwarded:
    type: timestamp
    read_only: true
    restriction_mode: A

  lead_motion_id:
    type: relation
    to: motion/amendment_ids
    references: motionT(id)
    equal_fields: meeting_id
    restriction_mode: C
  amendment_ids:
    type: relation-list
    to: motion/lead_motion_id
    equal_fields: meeting_id
    restriction_mode: C
  sort_parent_id:
    type: relation
    to: motion/sort_child_ids
    references: motionT(id)
    equal_fields: meeting_id
    restriction_mode: C
  origin_id:
    type: relation
    to: motion/derived_motion_ids # Note: The related motions may not be in the same meeting
    references: motionT(id)
    restriction_mode: A
  origin_meeting_id: # The meeting of the motion in origin_id, if any
    type: relation
    to: meeting/forwarded_motion_ids
    references: meetingT(id)
    restriction_mode: A
  derived_motion_ids:
    type: relation-list
    to: motion/origin_id # Note: The related motions may not be in the same meeting
    restriction_mode: A
  all_origin_ids: # Calculated: All parents (origin_id), grandparents, etc. of this motion.
    type: relation-list
    to: motion/all_derived_motion_ids
    restriction_mode: A
  all_derived_motion_ids: # Calculated: All children (derived_motion_ids), grandchildren, etc. of this motion.
    type: relation-list
    to: motion/all_origin_ids
    restriction_mode: A
  state_id:
    type: relation
    references: motion_state(id)
    to: motion_state/motion_ids
    required: true
    equal_fields: meeting_id
    restriction_mode: C
  recommendation_id:
    type: relation
    references: motion_state(id)
    to: motion_state/motion_recommendation_ids
    equal_fields: meeting_id
    restriction_mode: C
  state_extension_reference_ids:
    type: generic-relation-list
    to:
      collections:
        - motion
      field: referenced_in_motion_state_extension_ids
    equal_fields: meeting_id
    restriction_mode: C
  referenced_in_motion_state_extension_ids:
    type: relation-list
    to: motion/state_extension_reference_ids
    equal_fields: meeting_id
    restriction_mode: C
  recommendation_extension_reference_ids:
    type: generic-relation-list
    to:
      collections:
        - motion
      field: referenced_in_motion_recommendation_extension_ids
    equal_fields: meeting_id
    restriction_mode: C
  referenced_in_motion_recommendation_extension_ids:
    type: relation-list
    to: motion/recommendation_extension_reference_ids
    equal_fields: meeting_id
    restriction_mode: C
  category_id:
    type: relation
    references: motion_category(id)
    to: motion_category/motion_ids
    equal_fields: meeting_id
    restriction_mode: C
  block_id:
    type: relation
    references: motion_block(id)
    to: motion_block/motion_ids
    equal_fields: meeting_id
    restriction_mode: C
  submitter_ids:
    type: relation-list
    to: motion_submitter/motion_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  supporter_meeting_user_ids:
    type: relation-list
    to: meeting_user/supported_motion_ids
    equal_fields: meeting_id
    restriction_mode: C
  editor_id:
    type: relation
    to: meeting_user/editor_for_motion_ids
    equal_fields: meeting_id
    restriction_mode: B
  working_group_speaker_id:
    type: relation
    to: meeting_user/working_group_speaker_for_motion_ids
    equal_fields: meeting_id
    restriction_mode: B
  poll_ids:
    type: relation-list
    to: poll/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  option_ids:
    type: number[]
    restriction_mode: C
    Xsqlview: option/id, where option.content_motion_id = id
  change_recommendation_ids:
    type: relation-list
    to: motion_change_recommendation/motion_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  statute_paragraph_id:
    type: relation
    references: motion_statute_paragraph(id)
    to: motion_statute_paragraph/motion_ids
    equal_fields: meeting_id
    restriction_mode: C
  comment_ids:
    type: relation-list
    to: motion_comment/motion_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  agenda_item_id:
    type: relation
    references: agenda_item(id)
    to: agenda_item/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  list_of_speakers_id:
    type: relation
    references: list_of_speakers(id)
    to: list_of_speakers/content_object_id
    required: true
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: C
  tag_ids:
    type: relation-list
    to: tag/tagged_ids
    equal_fields: meeting_id
    restriction_mode: C
  attachment_ids:
    type: relation-list
    to: mediafile/attachment_ids
    equal_fields: meeting_id
    restriction_mode: C
  projection_ids:
    type: number[]
    to: projection/content_object_id
    equal_fields: meeting_id
    os3_on_delete: CASCADE
    restriction_mode: C
    Xsqlview: projection/id, where projection.projection_motion_id = id
  personal_note_ids:
    type: relation-list
    to: personal_note/content_object_id
    equal_fields: meeting_id
    os3_on_delete: CASCADE
    restriction_mode: C
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_ids
    required: true
    restriction_mode: A

motion_submitter:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  weight:
    type: number
    restriction_mode: A
  user_id:
    type: relation
    to: meeting_user/motion_submitter_ids
    references: userT(id)
    restriction_mode: A
    required: true
  motion_id:
    type: relation
    references: motionT(id)
    to: motion/submitter_ids
    equal_fields: meeting_id
    restriction_mode: A
    required: true
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_submitter_ids
    required: true
    restriction_mode: A

motion_comment:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  comment:
    type: HTMLStrict
    restriction_mode: A

  motion_id:
    type: relation
    references: motionT(id)
    to: motion/comment_ids
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  section_id:
    type: relation
    references: motion_comment_section(id)
    to: motion_comment_section/comment_ids
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    required: true
    restriction_mode: A

motion_comment_section:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A
  submitter_can_write:
    type: boolean
    restriction_mode: A

  comment_ids:
    type: relation-list
    to: motion_comment/section_id
    os3_on_delete: PROTECT
    equal_fields: meeting_id
    restriction_mode: A
  read_group_ids:
    type: relation-list
    to: group/read_comment_section_ids
    equal_fields: meeting_id
    restriction_mode: A
  write_group_ids:
    type: relation-list
    to: group/write_comment_section_ids
    equal_fields: meeting_id
    restriction_mode: A

motion_category:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  prefix:
    type: string
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  level:
    type: number
    description: Calculated field.
    read_only: true
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  parent_id:
    type: relation
    references: motion_category(id)
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_category_ids
    required: true
    restriction_mode: A

motion_block:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  internal:
    type: boolean
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  motion_ids:
    type: relation-list
    to: motion/block_id
    equal_fields: meeting_id
    restriction_mode: A
  agenda_item_id:
    type: relation
    references: agenda_item(id)
    to: agenda_item/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  list_of_speakers_id:
    type: relation
    references: list_of_speakers(id)
    to: list_of_speakers/content_object_id
    required: true
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_motion_block_id = id
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_block_ids
    required: true
    restriction_mode: A

motion_change_recommendation:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  rejected:
    type: boolean
    default: false
    restriction_mode: A
  internal:
    type: boolean
    default: false
    restriction_mode: A
  type:
    type: string
    enum:
      - replacement
      - insertion
      - deletion
      - other
    default: replacement
    restriction_mode: A
  other_description:
    type: string
    restriction_mode: A
  line_from:
    type: number
    minimum: 0
    restriction_mode: A
  line_to:
    type: number
    minimum: 0
    restriction_mode: A
  text:
    type: HTMLStrict
    restriction_mode: A
  creation_time:
    type: timestamp
    read_only: true
    restriction_mode: A

  motion_id:
    type: relation
    references: motionT(id)
    to: motion/change_recommendation_ids
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_change_recommendation_ids
    required: true
    restriction_mode: A

motion_state:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  weight:
    type: number
    required: true
    restriction_mode: A
  recommendation_label:
    type: string
    restriction_mode: A
  is_internal_recommendation:
    type: boolean
    restriction_mode: A
  css_class:
    type: string
    enum:
      - grey
      - red
      - green
      - lightblue
      - yellow
    default: lightblue
    required: true
    restriction_mode: A
  restrictions:
    type: string[]
    items:
      enum:
        - motion.can_see_internal
        - motion.can_manage_metadata
        - motion.can_manage
        - is_submitter
    restriction_mode: A
  allow_support:
    type: boolean
    default: false
    restriction_mode: A
  allow_create_poll:
    type: boolean
    default: false
    restriction_mode: A
  allow_submitter_edit:
    type: boolean
    default: false
    restriction_mode: A
  set_number:
    type: boolean
    default: true
    restriction_mode: A
  show_state_extension_field:
    type: boolean
    default: false
    restriction_mode: A
  show_recommendation_extension_field:
    type: boolean
    default: false
    restriction_mode: A
  merge_amendment_into_final:
    type: string
    enum:
      - do_not_merge
      - undefined
      - do_merge
    default: undefined
    restriction_mode: A
  allow_motion_forwarding:
    type: boolean
    restriction_mode: A
    default: false
  set_workflow_timestamp:
    type: boolean
    restriction_mode: A
    default: false
  submitter_withdraw_state_id:
    type: relation
    references: motion_state(id)
    to: motion_state/submitter_withdraw_back_ids
    equal_fields:
      - meeting_id
      - workflow_id
    restriction_mode: A
  submitter_withdraw_back_ids:
    type: relation-list
    to: motion_state/submitter_withdraw_state_id
    equal_fields:
      - meeting_id
      - workflow_id
    restriction_mode: A

  next_state_ids:
    type: relation-list
    to: motion_state/previous_state_ids
    equal_fields:
      - meeting_id
      - workflow_id
    restriction_mode: A
  previous_state_ids:
    type: relation-list
    to: motion_state/next_state_ids
    equal_fields:
      - meeting_id
      - workflow_id
    restriction_mode: A
  motion_ids:
    type: relation-list
    to: motion/state_id
    os3_on_delete: PROTECT
    equal_fields: meeting_id
    restriction_mode: A
  motion_recommendation_ids:
    type: relation-list
    to: motion/recommendation_id
    equal_fields: meeting_id
    restriction_mode: A
  workflow_id:
    type: relation
    references: motion_workflow(id)
    to: motion_workflow/state_ids
    required: true
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_state_ids
    required: true
    restriction_mode: A

motion_state_to_state:
  entity_description:
    type: table
  previous_state_id:
    type: relation
    references: motion_state(id)
    required: true
  next_state_id:
    type: relation
    references: motion_state(id)
    required: true

motion_workflow:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A
  state_ids:
    type: relation-list
    to: motion_state/workflow_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  first_state_id:
    type: relation
    references: motion_state(id)
    deferred_foreign_key: true
    required: true
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    required: true
    restriction_mode: A

motion_statute_paragraph:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  text:
    type: HTMLStrict
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  motion_ids:
    type: relation-list
    to: motion/statute_paragraph_id
    equal_fields: meeting_id
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/motion_statute_paragraph_ids
    required: true
    restriction_mode: A

poll:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  description:
    type: text
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  type:
    type: string
    required: true
    enum:
      - analog
      - named
      - pseudoanonymous
      - cryptographic
    restriction_mode: A
  backend:
    type: string
    required: True
    default: fast
    enum:
      - long
      - fast
    restriction_mode: A
  is_pseudoanonymized:
    type: boolean
    restriction_mode: A
  pollmethod:
    type: string
    required: true
    enum:
      - "Y"
      - "YN"
      - "YNA"
      - "N"
    restriction_mode: A
  state:
    type: string
    enum:
      - created
      - started
      - finished
      - published
    default: created
    restriction_mode: A
  min_votes_amount:
    type: number
    default: 1
    minimum: 1
    restriction_mode: A
  max_votes_amount:
    type: number
    default: 1
    minimum: 1
    restriction_mode: A
  max_votes_per_option:
    type: number
    default: 1
    minimum: 1
    restriction_mode: A
  global_yes:
    type: boolean
    default: false
    restriction_mode: A
  global_no:
    type: boolean
    default: false
    restriction_mode: A
  global_abstain:
    type: boolean
    default: false
    restriction_mode: A
  onehundred_percent_base:
    type: string
    required: true
    enum:
      - "Y"
      - "YN"
      - "YNA"
      - "N"
      - "valid"
      - "cast"
      - "entitled"
      - "disabled"
    default: disabled
    restriction_mode: A
  votesvalid:
    type: decimal
    restriction_mode: B
  votesinvalid:
    type: decimal
    restriction_mode: B
  votescast:
    type: decimal
    restriction_mode: D
  entitled_users_at_stop:
    type: JSON
    restriction_mode: A
  vote_count:
    type: number
    calculated: true
    description: get it from vote-service, anyway not handled by backend
    restriction_mode: C
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A
  crypt_key:
    type: string
    description: base64 public key to cryptographic votes.
    read_only: true
    restriction_mode: A
  crypt_signature:
    type: string
    description: base64 signature of cryptographic_key.
    read_only: true
    restriction_mode: A
  votes_raw:
    type: text
    description: original form of decrypted votes.
    read_only: true
    restriction_mode: B
  votes_signature:
    type: string
    description: base64 signature of votes_raw field.
    read_only: true
    restriction_mode: B
  content_object_id:
    type: generic-relation
    to:
      collections:
        - motion
        - assignment
        - topic
      field: poll_ids
    equal_fields: meeting_id
    restriction_mode: A
    required: true
  option_ids:
    type: relation-list
    to: option/poll_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  global_option_id:
    type: relation
    references: option(id)
    to: option/used_as_global_option_in_poll_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  voted_ids:
    type: number[]
    to: user/poll_voted_ids
    restriction_mode: A
    Xsqlview: poll_to_user/user_id, where poll_to_user.poll_id = id
  entitled_group_ids:
    type: relation-list
    to: group/poll_ids
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_poll_id = id
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/poll_ids
    restriction_mode: A
    required: true

option:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  text:
    type: HTMLStrict
    restriction_mode: A
  "yes":
    type: decimal
    restriction_mode: B
  "no":
    type: decimal
    restriction_mode: B
  abstain:
    type: decimal
    restriction_mode: B

  poll_id:
    type: relation
    references: poll(id)
    on_delete: CASCADE
    to: poll/option_ids
    equal_fields: meeting_id
    restriction_mode: A
  vote_ids:
    type: relation-list
    to: vote/option_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A

  # todo: only 1 of the next 3 should be filled, but is not required. Replaces a content_object
  content_motion_id:
    type: relation
    references: motionT(id)
    restriction_mode: A
  content_user_id:
    type: relation
    references: userT(id)
    restriction_mode: A
  content_poll_candidate_list_id:
    type: relation
    references: poll_candidate_list(id)
    restriction_mode: A
    description: poll_candidate_list.option_id must be filled also, because it is required and not modelled as sqlview
vote:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  weight:
    type: decimal
    restriction_mode: A
  value:
    type: string
    restriction_mode: A
  user_token:
    type: string
    required: true
    restriction_mode: B

  option_id:
    type: relation
    references: option(id)
    on_delete: CASCADE
    to: option/vote_ids
    equal_fields: meeting_id
    required: true
    restriction_mode: A
  user_id:
    type: relation
    references: userT(id)
    restriction_mode: A
  delegated_user_id:
    type: relation
    references: userT(id)
    restriction_mode: A

assignment:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  description:
    type: HTMLStrict
    restriction_mode: A
  open_posts:
    type: number
    minimum: 0
    default: 0
    restriction_mode: A
  phase:
    type: string
    enum:
      - search
      - voting
      - finished
    default: search
    restriction_mode: A
  default_poll_description:
    type: text
    restriction_mode: A
  number_poll_candidates:
    type: boolean
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  candidate_ids:
    type: relation-list
    to: assignment_candidate/assignment_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  poll_ids:
    type: relation-list
    to: poll/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  agenda_item_id:
    type: relation
    references: agenda_item(id)
    to: agenda_item/content_object_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  list_of_speakers_id:
    type: relation
    references: list_of_speakers(id)
    to: list_of_speakers/content_object_id
    required: true
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  tag_ids:
    type: relation-list
    to: tag/tagged_ids
    equal_fields: meeting_id
    restriction_mode: A
  attachment_ids:
    type: relation-list
    to: mediafile/attachment_ids
    equal_fields: meeting_id
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_assignment_id = id
  meeting_id:
    type: relation
    references: meetingT(id)
    on_delete: CASCADE
    to: meeting/assignment_ids
    required: true
    restriction_mode: A

assignment_candidate:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A

  assignment_id:
    type: relation
    references: assignment(id)
    on_delete: CASCADE
    to: assignment/candidate_ids
    equal_fields: meeting_id
    restriction_mode: A
    required: true
  user_id:
    type: relation
    references: userT(id)
    to: meeting_user/assignment_candidate_ids
    restriction_mode: A

# models for the poll list election
poll_candidate_list:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  poll_candidate_ids:
    type: number[]
    os3_on_delete: CASCADE
    restriction_mode: A
    Xsqlview: poll_candidate/id, where poll_candidate_list_id = id
  option_id:
    type: number
    references: option(id)
    on_delete: CASCADE
    required: true
    restriction_mode: A
    description: option.content_poll_candidate_list_id must be filled also, because it is an old content_object-field

poll_candidate:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  poll_candidate_list_id:
    type: relation
    references: poll_candidate_list(id)
    on_delete: CASCADE
    restriction_mode: A
    required: true
  user_id:
    type: relation
    references: userT(id)
    to: user/poll_candidate_ids
    restriction_mode: A
  weight:
    type: number
    required: true
    restriction_mode: A

# Mediafiles are delivered by the mediafile server with the URL
# `<media-prefix>/media/<meeting_id>/path`
mediafile:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    description: Title and parent_id must be unique.
    restriction_mode: A
  is_directory:
    type: boolean
    restriction_mode: A
  filesize:
    type: number
    description: In bytes, not the human readable format anymore.
    read_only: true
    restriction_mode: A
  filename:
    type: string
    description: The uploaded filename. Will be used for downloading. Only writeable on create.
    restriction_mode: A
  mimetype:
    type: string
    restriction_mode: A
  pdf_information:
    type: JSON
    restriction_mode: A
  create_timestamp:
    type: timestamp
    restriction_mode: A
  is_public:
    type: boolean
    description: "Calculated field. inherited_access_group_ids == [] can have two causes: cancelling access groups (=> is_public := false) or no access groups at all (=> is_public := true)"
    read_only: true
    required: true
    restriction_mode: A
  token:
    type: string
    restriction_mode: A
  inherited_access_group_ids:
    type: relation-list
    to: group/mediafile_inherited_access_group_ids
    description: Calculated field.
    read_only: true
    restriction_mode: A
  access_group_ids:
    type: relation-list
    to: group/mediafile_access_group_ids
    restriction_mode: A
  parent_id:
    type: relation
    references: mediafile(id)
    equal_fields: owner_id
    restriction_mode: A
  list_of_speakers_id:
    type: relation
    references: list_of_speakers(id)
    to: list_of_speakers/content_object_id
    os3_on_delete: CASCADE
    restriction_mode: A
  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_mediafile_id = id
  attachment_ids:
    type: generic-relation-list
    to:
      collections:
        - motion
        - topic
        - assignment
      field: attachment_ids
    restriction_mode: A
  owner_meeting_id:
    type: relation
    references: meetingT(id)
    todo: constraint for only meeting_id or organization_id filled, but one is required
  owner_organization_id:
    type: relation
    references: organizationT(id)
    todo: constraint for only meeting_id or organization_id filled, but one is required

projector:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    restriction_mode: A
  is_internal:
    type: boolean
    default: false
    restriction_mode: A
  scale:
    type: number
    default: 0
    restriction_mode: A
  scroll:
    type: number
    default: 0
    minimum: 0
    restriction_mode: A
  width:
    type: number
    minimum: 1
    default: 1200
    restriction_mode: A
  aspect_ratio_numerator:
    type: number
    minimum: 1
    default: 16
    restriction_mode: A
  aspect_ratio_denominator:
    type: number
    minimum: 1
    default: 9
    restriction_mode: A
  color:
    type: color
    default: "#000000"
    restriction_mode: A
  background_color:
    type: color
    default: "#ffffff"
    restriction_mode: A
  header_background_color:
    type: color
    default: "#317796"
    restriction_mode: A
  header_font_color:
    type: color
    default: "#f5f5f5"
    restriction_mode: A
  header_h1_color:
    type: color
    default: "#317796"
    restriction_mode: A
  chyron_background_color:
    type: color
    default: "#317796"
    restriction_mode: A
  chyron_font_color:
    type: color
    default: "#ffffff"
    restriction_mode: A
  show_header_footer:
    type: boolean
    default: true
    restriction_mode: A
  show_title:
    type: boolean
    default: true
    restriction_mode: A
  show_logo:
    type: boolean
    default: true
    restriction_mode: A
  show_clock:
    type: boolean
    default: true
    restriction_mode: A
  sequential_number:
    type: number
    description: The (positive) serial number of this model in its meeting. This number is auto-generated and read-only.
    read_only: true
    required: true
    restriction_mode: A

  current_projection_ids:
    type: relation-list
    to: projection/current_projector_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  preview_projection_ids:
    type: relation-list
    to: projection/preview_projector_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  history_projection_ids:
    type: relation-list
    to: projection/history_projector_id
    os3_on_delete: CASCADE
    equal_fields: meeting_id
    restriction_mode: A
  used_as_reference_projector_meeting_id:
    type: number
    to: meeting/reference_projector_id
    restriction_mode: A
  used_as_default_projector_for_agenda_item_list_in_meeting_id:
    type: relation
    to: meeting/default_projector_agenda_item_list_ids
    restriction_mode: A
  used_as_default_projector_for_topic_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_list_of_speakers_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_cur_list_of_speaker_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_motion_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_amendment_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_motion_block_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_assignment_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_mediafile_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_message_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_projector_countdown_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_assignment_poll_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_motion_poll_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  used_as_default_projector_for_poll_in_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    on_delete: CASCADE
    to: meeting/projector_ids
    restriction_mode: A
    required: true

# A projection is a M2M model between an element that is assigned to a
# projector. This element can either be the current one projected, in the
# preview, or in the history, but not more than one once. A projection is
# projector-specific, meaning that once a projection is created for a projector
# and element, these references will not change.
projection:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  options:
    type: JSON
    restriction_mode: A
  stable:
    type: boolean
    default: false
    restriction_mode: A
  weight:
    type: number
    restriction_mode: A
  type:
    type: string
    restriction_mode: A

  content:
    type: JSON
    calculated: true
    restriction_mode: A

  current_projector_id:
    type: relation
    references: projector(id)
    to: projector/current_projection_ids
    equal_fields: meeting_id
    restriction_mode: A
    todo: only one of current_projector_id, preview_projector_id and history_projector_id, but this is required
  preview_projector_id:
    type: relation
    references: projector(id)
    to: projector/preview_projection_ids
    equal_fields: meeting_id
    restriction_mode: A
  history_projector_id:
    type: relation
    references: projector(id)
    to: projector/history_projection_ids
    equal_fields: meeting_id
    restriction_mode: A
  projection_meeting_id:
    type: relation
    references: meetingT(id)
    restriction_mode: A
    todo: only one of the projection_xxx_id, but this is required
  projection_motion_id:
    type: relation
    references: motionT(id)
    restriction_mode: A
  projection_mediafile_id:
    type: relation
    references: mediafile(id)
    restriction_mode: A
  projection_list_of_speakers_id:
    type: relation
    references: list_of_speakers(id)
    restriction_mode: A
  projection_motion_block_id:
    type: relation
    references: motion_block(id)
    restriction_mode: A
  projection_assignment_id:
    type: relation
    references: assignment(id)
    restriction_mode: A
  projection_agenda_item_id:
    type: relation
    references: agenda_item(id)
    restriction_mode: A
  projection_topic_id:
    type: relation
    references: topic(id)
    restriction_mode: A
  projection_poll_id:
    type: relation
    references: poll(id)
    restriction_mode: A
  projection_projector_message_id:
    type: relation
    references: projector_message(id)
    restriction_mode: A
  projection_projector_countdown_id:
    type: relation
    references: projector_countdown(id)
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/all_projection_ids
    required: true
    restriction_mode: A

projector_message:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  message:
    type: HTMLStrict
    restriction_mode: A

  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_projector_message_id = id
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/projector_message_ids
    restriction_mode: A
    required: true

projector_countdown:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  title:
    type: string
    required: true
    restriction_mode: A
  description:
    type: string
    default: ""
    restriction_mode: A
  default_time:
    type: number
    restriction_mode: A
  countdown_time:
    type: float
    default: 60
    restriction_mode: A
  running:
    type: boolean
    default: false
    restriction_mode: A

  projection_ids:
    type: number[]
    restriction_mode: A
    Xsqlview: projection/id, where projection.projection_projector_countdown_id = id
  used_as_list_of_speakers_countdown_meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/list_of_speakers_countdown_id
    restriction_mode: A
  used_as_poll_countdown_meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/poll_countdown_id
    restriction_mode: A
  meeting_id:
    type: relation
    references: meetingT(id)
    to: meeting/projector_countdown_ids
    restriction_mode: A
    required: true

chat_groupT:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  weight:
    type: number
    default: 10000
    restriction_mode: A
  meeting_id:
    type: relation
    to: meeting/chat_group_ids
    required: true
    restriction_mode: A

chat_group:
  entity_description:
    type: view
    table: chat_groupT
    table_letter: cg
  chat_message_ids:
    type: number[]
    restriction_mode: A
    select: "select array_agg(m.id) from chat_message m where m.chat_group_id = cg.id"
  read_group_ids:
    type: number[]
    restriction_mode: A
    select: select array_agg(gtg.group_id) from chat_group_to_group gtg where gtg.chat_group_id = cg.id and gtg.read
  write_group_ids:
    type: number[]
    restriction_mode: A
    select: select array_agg(gtg.group_id) from chat_group_to_group gtg where gtg.chat_group_id = cg.id and gtg.write

chat_group_to_group:
  entity_description:
    type: table
  chat_group_id:
    type: relation
    references: chat_groupT(id)
    required: true
  group_id:
    type: relation
    references: groupT(id)
    required: true
  read:
    type: boolean
    default: true
  write:
    type: boolean
    default: false

chat_message:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  content:
    type: HTMLStrict 
    required: true
    restriction_mode: A
  created:
    type: timestamp
    required: true
    restriction_mode: A
  user_id:
    type: relation
    references: userT(id)
    restriction_mode: A
    required: true
  chat_group_id:
    type: relation
    references: chat_groupT(id)
    restriction_mode: A
    required: true

action_worker:
  entity_description:
    type: table
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    restriction_mode: A
  state:
    type: string
    required: true
    enum:
      - running
      - end
      - aborted
    restriction_mode: A
  created:
    type: timestamp
    required: true
    restriction_mode: A
  timestamp:
    type: timestamp
    required: true
    restriction_mode: A
  result:
    type: JSON
    restriction_mode: A

import_preview:
  id:
    type: number
    restriction_mode: A
  name:
    type: string
    required: true
    enum:
      - account
      - participant
      - topic
      - committee
    restriction_mode: A
  state:
    type: string
    required: true
    enum:
      - warning
      - error
      - done
    restriction_mode: A
  created:
    type: timestamp
    required: true
    restriction_mode: A
  result:
    type: JSON
    restriction_mode: A
